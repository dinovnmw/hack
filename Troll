local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local runService = game:GetService("RunService")
local userInput = game:GetService("UserInputService")
local camera = workspace.CurrentCamera
local tweenService = game:GetService("TweenService")

-- State management
local states = {
    Mode = "None",
    God = false,
    Freecam = false,
    Possess = false,
    AntiScript = false,
    UIHidden = false
}

local config = {
    freecamSpeed = 2,
    freecamBoost = 6,
    deleteRadius = 25,
    gridSnap = 1,
    teleportTweenTime = 0.2
}

local undoStack = {}
local draggingPart = nil
local highlight = nil
local possessTarget = nil
local vel = Vector3.zero

-- Create main GUI
local gui = Instance.new("ScreenGui", player.PlayerGui)
gui.Name = "AdvancedAdminUI"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true

-- Main container with glass effect
local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 620, 0, 650)
main.Position = UDim2.new(0, 30, 0.5, -325)
main.BackgroundColor3 = Color3.fromRGB(10, 10, 20)
main.BackgroundTransparency = 0.1
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true

-- Glass effect
local glass = Instance.new("Frame", main)
glass.Size = UDim2.new(1, 0, 1, 0)
glass.BackgroundTransparency = 0.95
glass.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
glass.BorderSizePixel = 0
Instance.new("UICorner", glass).CornerRadius = UDim.new(0, 14)

-- Neon border
local border = Instance.new("UIStroke", main)
border.Color = Color3.fromRGB(0, 255, 255)
border.Thickness = 3
border.Transparency = 0.3

-- Inner glow
local innerGlow = Instance.new("Frame", main)
innerGlow.Size = UDim2.new(1, -6, 1, -6)
innerGlow.Position = UDim2.new(0, 3, 0, 3)
innerGlow.BackgroundTransparency = 1
innerGlow.BorderSizePixel = 0
local innerStroke = Instance.new("UIStroke", innerGlow)
innerStroke.Color = Color3.fromRGB(0, 200, 255)
innerStroke.Thickness = 1
innerStroke.Transparency = 0.5
Instance.new("UICorner", innerGlow).CornerRadius = UDim.new(0, 11)

-- Corner rounding
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 14)

-- Title bar with neon effect
local titleBar = Instance.new("Frame", main)
titleBar.Size = UDim2.new(1, 0, 0, 50)
titleBar.BackgroundColor3 = Color3.fromRGB(15, 15, 30)
titleBar.BackgroundTransparency = 0.2
titleBar.BorderSizePixel = 0
Instance.new("UICorner", titleBar).CornerRadius = UDim.new(0, 14)

local titleBarStroke = Instance.new("UIStroke", titleBar)
titleBarStroke.Color = Color3.fromRGB(0, 255, 255)
titleBarStroke.Thickness = 2
titleBarStroke.Transparency = 0.3

local title = Instance.new("TextLabel", titleBar)
title.Size = UDim2.new(0.7, 0, 1, 0)
title.Position = UDim2.new(0.05, 0, 0, 0)
title.Text = "‚ö° DINOTROLL v2.0 ‚ö°"
title.Font = Enum.Font.GothamBlack
title.TextSize = 18
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundTransparency = 1
title.TextStrokeTransparency = 0.8
title.TextStrokeColor3 = Color3.fromRGB(0, 255, 255)

-- Hide/Show button (TOP RIGHT)
local hideButton = Instance.new("TextButton", titleBar)
hideButton.Size = UDim2.new(0, 30, 0, 30)
hideButton.Position = UDim2.new(1, -40, 0.5, -15)
hideButton.Text = "‚àí"
hideButton.Font = Enum.Font.GothamBlack
hideButton.TextSize = 20
hideButton.TextColor3 = Color3.fromRGB(255, 255, 255)
hideButton.BackgroundColor3 = Color3.fromRGB(30, 30, 60)
hideButton.BackgroundTransparency = 0.2
hideButton.BorderSizePixel = 0
Instance.new("UICorner", hideButton).CornerRadius = UDim.new(1, 0)

local hideButtonStroke = Instance.new("UIStroke", hideButton)
hideButtonStroke.Color = Color3.fromRGB(0, 255, 255)
hideButtonStroke.Thickness = 2

-- Minimize/Expand button (BOTTOM CENTER - NEW)
local minimizeButton = Instance.new("TextButton", gui)
minimizeButton.Size = UDim2.new(0, 40, 0, 40)
minimizeButton.Position = UDim2.new(0.5, -20, 1, -50)
minimizeButton.Text = "‚ñ≤"
minimizeButton.Font = Enum.Font.GothamBlack
minimizeButton.TextSize = 24
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.BackgroundColor3 = Color3.fromRGB(0, 20, 40)
minimizeButton.BackgroundTransparency = 0.2
minimizeButton.BorderSizePixel = 0
minimizeButton.Visible = false
Instance.new("UICorner", minimizeButton).CornerRadius = UDim.new(1, 0)

local minimizeStroke = Instance.new("UIStroke", minimizeButton)
minimizeStroke.Color = Color3.fromRGB(0, 255, 255)
minimizeStroke.Thickness = 3

-- Status display
local status = Instance.new("TextLabel", main)
status.Position = UDim2.new(0.05, 0, 0.09, 10)
status.Size = UDim2.new(0.9, 0, 0, 35)
status.BackgroundColor3 = Color3.fromRGB(20, 20, 40)
status.BackgroundTransparency = 0.3
status.TextXAlignment = Enum.TextXAlignment.Left
status.Font = Enum.Font.GothamSemibold
status.TextSize = 13
status.TextColor3 = Color3.fromRGB(200, 255, 255)
status.Text = "‚ö° Mode: None | Freecam: OFF | God: OFF"
status.TextStrokeTransparency = 0.8
status.TextStrokeColor3 = Color3.fromRGB(0, 150, 255)
Instance.new("UICorner", status).CornerRadius = UDim.new(0, 8)

local statusStroke = Instance.new("UIStroke", status)
statusStroke.Color = Color3.fromRGB(0, 200, 255)
statusStroke.Thickness = 1
statusStroke.Transparency = 0.5

-- Content container (to hide/show)
local contentContainer = Instance.new("Frame", main)
contentContainer.Size = UDim2.new(1, 0, 1, -60)
contentContainer.Position = UDim2.new(0, 0, 0, 60)
contentContainer.BackgroundTransparency = 1
contentContainer.Visible = true

-- Function to update status with neon effect
local function updateStatus()
    local modeColor = {
        None = "‚ö™",
        Delete = "üî¥",
        Move = "üîµ", 
        Teleport = "üü†"
    }
    
    local modeIcon = modeColor[states.Mode] or "‚ö™"
    
    status.Text = string.format("%s Mode: %s | Freecam: %s | God: %s",
        modeIcon,
        states.Mode,
        states.Freecam and "ON" or "OFF",
        states.God and "ON" or "OFF"
    )
end

-- Function to create neon buttons
local function makeNeonButton(text, y, cb, color)
    local buttonContainer = Instance.new("Frame", contentContainer)
    buttonContainer.Size = UDim2.new(0.9, 0, 0, 40)
    buttonContainer.Position = UDim2.new(0.05, 0, y, 0)
    buttonContainer.BackgroundTransparency = 1
    
    local b = Instance.new("TextButton", buttonContainer)
    b.Size = UDim2.new(1, 0, 1, 0)
    b.Text = text
    b.Font = Enum.Font.GothamBold
    b.TextSize = 14
    b.TextColor3 = Color3.fromRGB(255, 255, 255)
    b.BackgroundColor3 = Color3.fromRGB(30, 30, 60)
    b.BackgroundTransparency = 0.2
    b.AutoButtonColor = true
    b.ClipsDescendants = true
    
    -- Liquid glass effect
    local liquidEffect = Instance.new("Frame", b)
    liquidEffect.Size = UDim2.new(1, 0, 0.5, 0)
    liquidEffect.Position = UDim2.new(0, 0, 0, 0)
    liquidEffect.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    liquidEffect.BackgroundTransparency = 0.9
    liquidEffect.BorderSizePixel = 0
    
    -- Neon border
    local buttonStroke = Instance.new("UIStroke", b)
    buttonStroke.Color = color
    buttonStroke.Thickness = 2
    buttonStroke.Transparency = 0.3
    
    -- Rounded corners
    local corner = Instance.new("UICorner", b)
    corner.CornerRadius = UDim.new(0, 8)
    
    -- Hover effect
    b.MouseEnter:Connect(function()
        tweenService:Create(buttonStroke, TweenInfo.new(0.2), {Transparency = 0}):Play()
        tweenService:Create(b, TweenInfo.new(0.2), {BackgroundTransparency = 0.1}):Play()
    end)
    
    b.MouseLeave:Connect(function()
        tweenService:Create(buttonStroke, TweenInfo.new(0.2), {Transparency = 0.3}):Play()
        tweenService:Create(b, TweenInfo.new(0.2), {BackgroundTransparency = 0.2}):Play()
    end)
    
    b.MouseButton1Click:Connect(function()
        -- Click animation
        tweenService:Create(b, TweenInfo.new(0.1), {Size = UDim2.new(0.95, 0, 0.95, 0)}):Play()
        task.wait(0.1)
        tweenService:Create(b, TweenInfo.new(0.1), {Size = UDim2.new(1, 0, 1, 0)}):Play()
        
        cb(b)
    end)
    
    return b
end

-- Create neon buttons
local buttons = {}
buttons.delete = makeNeonButton("üóëÔ∏è MODE DELETE", 0.12, function(b)
    states.Mode = states.Mode == "Delete" and "None" or "Delete"
    b.BackgroundColor3 = states.Mode == "Delete" and Color3.fromRGB(180, 50, 50) or Color3.fromRGB(30, 30, 60)
    updateStatus()
end, Color3.fromRGB(255, 50, 50))

buttons.move = makeNeonButton("‚ÜîÔ∏è MODE MOVE", 0.19, function(b)
    states.Mode = states.Mode == "Move" and "None" or "Move"
    b.BackgroundColor3 = states.Mode == "Move" and Color3.fromRGB(50, 120, 200) or Color3.fromRGB(30, 30, 60)
    updateStatus()
end, Color3.fromRGB(50, 150, 255))

buttons.teleport = makeNeonButton("üìç MODE TELEPORT", 0.26, function(b)
    states.Mode = states.Mode == "Teleport" and "None" or "Teleport"
    b.BackgroundColor3 = states.Mode == "Teleport" and Color3.fromRGB(200, 120, 50) or Color3.fromRGB(30, 30, 60)
    updateStatus()
end, Color3.fromRGB(255, 150, 50))

buttons.god = makeNeonButton("üõ°Ô∏è GOD MODE", 0.33, function(b)
    states.God = not states.God
    b.Text = states.God and "üõ°Ô∏è GOD MODE ON" or "üõ°Ô∏è GOD MODE OFF"
    b.BackgroundColor3 = states.God and Color3.fromRGB(50, 180, 50) or Color3.fromRGB(30, 30, 60)
    updateStatus()
end, Color3.fromRGB(50, 255, 50))

buttons.freecam = makeNeonButton("üé• FREECAM", 0.40, function(b)
    states.Freecam = not states.Freecam
    b.Text = states.Freecam and "üé• FREECAM ON" or "üé• FREECAM OFF"
    b.BackgroundColor3 = states.Freecam and Color3.fromRGB(180, 180, 50) or Color3.fromRGB(30, 30, 60)

    if states.Freecam then
        camera.CameraType = Enum.CameraType.Scriptable
    else
        camera.CameraType = Enum.CameraType.Custom
        if player.Character then
            camera.CameraSubject = player.Character:FindFirstChild("Humanoid")
        end
    end

    updateStatus()
end, Color3.fromRGB(255, 255, 50))

buttons.possess = makeNeonButton("üë§ POSSESS", 0.47, function(b)
    states.Possess = not states.Possess
    b.Text = states.Possess and "üë§ POSSESS ON" or "üë§ POSSESS OFF"
    b.BackgroundColor3 = states.Possess and Color3.fromRGB(150, 50, 200) or Color3.fromRGB(30, 30, 60)

    if not states.Possess then
        possessTarget = nil
        if player.Character then
            camera.CameraSubject = player.Character:FindFirstChild("Humanoid")
        end
    end

    updateStatus()
end, Color3.fromRGB(200, 50, 255))

buttons.antiScript = makeNeonButton("üõ°Ô∏è ANTI SCRIPT", 0.54, function(b)
    states.AntiScript = not states.AntiScript
    b.Text = states.AntiScript and "üõ°Ô∏è ANTI SCRIPT ON" or "üõ°Ô∏è ANTI SCRIPT OFF"
    b.BackgroundColor3 = states.AntiScript and Color3.fromRGB(50, 150, 50) or Color3.fromRGB(30, 30, 60)
end, Color3.fromRGB(50, 255, 50))

buttons.deleteNearby = makeNeonButton("üí• DELETE NEARBY", 0.61, function(b)
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then return end

    local root = player.Character.HumanoidRootPart
    local count = 0

    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and not obj:IsDescendantOf(player.Character) then
            if (obj.Position - root.Position).Magnitude <= config.deleteRadius then
                table.insert(undoStack, obj:Clone())
                obj:Destroy()
                count += 1
            end
        end
    end
    
    -- Flash effect
    b.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
    task.wait(0.1)
    b.BackgroundColor3 = Color3.fromRGB(30, 30, 60)
end, Color3.fromRGB(255, 100, 100))

buttons.undoDelete = makeNeonButton("‚Ü©Ô∏è UNDO DELETE", 0.68, function(b)
    local last = table.remove(undoStack)
    if last then
        last.Parent = workspace
        
        -- Flash effect
        b.BackgroundColor3 = Color3.fromRGB(100, 255, 100)
        task.wait(0.1)
        b.BackgroundColor3 = Color3.fromRGB(30, 30, 60)
    end
end, Color3.fromRGB(100, 255, 100))

-- Highlight effect for selected parts
local function getHighlight()
    if not highlight then
        highlight = Instance.new("Highlight")
        highlight.FillTransparency = 0.8
        highlight.FillColor = Color3.fromRGB(0, 100, 255)
        highlight.OutlineColor = Color3.fromRGB(0, 255, 255)
        highlight.OutlineTransparency = 0
    end
    return highlight
end

-- Teleport function with neon trail effect
local function teleportTo(position)
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end

    local root = char.HumanoidRootPart
    
    -- Create trail effect
    local trail = Instance.new("Part")
    trail.Size = Vector3.new(0.5, 0.5, 0.5)
    trail.Position = root.Position
    trail.Anchored = true
    trail.CanCollide = false
    trail.Material = EnumMaterial.Neon
    trail.BrickColor = BrickColor.new("Cyan")
    trail.Parent = workspace
    
    local goal = {CFrame = CFrame.new(position + Vector3.new(0, 3, 0))}
    local tween = tweenService:Create(root, TweenInfo.new(config.teleportTweenTime, Enum.EasingStyle.Quad), goal)
    tween:Play()
    
    -- Clean up trail
    game:GetService("Debris"):AddItem(trail, 1)
end

-- UI Toggle function
local function toggleUI()
    states.UIHidden = not states.UIHidden
    
    if states.UIHidden then
        -- Hide UI
        contentContainer.Visible = false
        status.Visible = false
        main.Size = UDim2.new(0, 300, 0, 50)  -- Minimize to title bar only
        hideButton.Text = "+"
        minimizeButton.Visible = true
        
        -- Animate
        tweenService:Create(main, TweenInfo.new(0.3), {Size = UDim2.new(0, 300, 0, 50)}):Play()
    else
        -- Show UI
        contentContainer.Visible = true
        status.Visible = true
        main.Size = UDim2.new(0, 620, 0, 650)
        hideButton.Text = "‚àí"
        minimizeButton.Visible = false
        
        -- Animate
        tweenService:Create(main, TweenInfo.new(0.3), {Size = UDim2.new(0, 620, 0, 650)}):Play()
    end
end

-- Connect hide/show buttons
hideButton.MouseButton1Click:Connect(toggleUI)
minimizeButton.MouseButton1Click:Connect(toggleUI)

-- Main update loop with visual effects
runService.RenderStepped:Connect(function(dt)
    -- Pulsing neon effect for border
    local pulse = math.sin(tick() * 3) * 0.2 + 0.8
    border.Transparency = 0.5 - (pulse * 0.2)
    
    if states.Freecam then
        local move = Vector3.zero
        local cf = camera.CFrame
        local look = cf.LookVector
        local right = cf.RightVector

        if userInput:IsKeyDown(Enum.KeyCode.W) then move = move + look end
        if userInput:IsKeyDown(Enum.KeyCode.S) then move = move - look end
        if userInput:IsKeyDown(Enum.KeyCode.D) then move = move + right end
        if userInput:IsKeyDown(Enum.KeyCode.A) then move = move - right end
        if userInput:IsKeyDown(Enum.KeyCode.E) then move = move + Vector3.new(0, 1, 0) end
        if userInput:IsKeyDown(Enum.KeyCode.Q) then move = move - Vector3.new(0, 1, 0) end

        local speed = config.freecamSpeed
        if userInput:IsKeyDown(Enum.KeyCode.LeftShift) then
            speed = config.freecamBoost
        elseif userInput:IsKeyDown(Enum.KeyCode.LeftControl) then
            speed = config.freecamSpeed * 0.5
        end

        vel = vel:Lerp(move * speed, 0.15)
        camera.CFrame = camera.CFrame + vel
    end

    if states.God and player.Character and player.Character:FindFirstChild("Humanoid") then
        local hum = player.Character.Humanoid
        hum.Health = hum.MaxHealth
        hum:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, false)
        
        -- Visual god mode effect
        if not states.UIHidden then
            status.TextColor3 = Color3.fromRGB(100, 255, 100)
        end
    else
        if not states.UIHidden then
            status.TextColor3 = Color3.fromRGB(200, 255, 255)
        end
    end

    if draggingPart and states.Mode == "Move" then
        local pos = mouse.Hit.Position

        if config.gridSnap > 0 then
            pos = Vector3.new(
                math.round(pos.X / config.gridSnap) * config.gridSnap,
                math.round(pos.Y / config.gridSnap) * config.gridSnap,
                math.round(pos.Z / config.gridSnap) * config.gridSnap
            )
        end

        draggingPart.Position = pos
    end
end)

-- Mouse interactions
mouse.Button1Down:Connect(function()
    local t = mouse.Target
    if not t then return end

    if states.Possess then
        local m = t:FindFirstAncestorOfClass("Model")
        if m and m:FindFirstChild("Humanoid") then
            possessTarget = m
            camera.CameraSubject = m.Humanoid
        end

    elseif states.Mode == "Delete" and not t:IsDescendantOf(player.Character) then
        table.insert(undoStack, t:Clone())
        t:Destroy()

    elseif states.Mode == "Move" and t:IsA("BasePart") and not t:IsDescendantOf(player.Character) then
        draggingPart = t
        draggingPart.Anchored = true
        local h = getHighlight()
        h.Parent = t

    elseif states.Mode == "Teleport" then
        teleportTo(mouse.Hit.Position)
    end
end)

mouse.Button1Up:Connect(function()
    if draggingPart then
        draggingPart.Anchored = false
        if highlight then highlight.Parent = nil end
    end
    draggingPart = nil
end)

-- Keyboard shortcuts
userInput.InputBegan:Connect(function(i, gp)
    if gp then return end

    if i.KeyCode == Enum.KeyCode.F then
        states.Freecam = not states.Freecam
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.G then
        states.God = not states.God
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.X then
        states.Mode = states.Mode == "Delete" and "None" or "Delete"
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.C then
        states.Mode = states.Mode == "Move" and "None" or "Move"
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.T then
        states.Mode = states.Mode == "Teleport" and "None" or "Teleport"
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.H then
        toggleUI()  -- Added shortcut to hide/show UI
    end
end)

-- Anti-script protection
player.CharacterAdded:Connect(function(char)
    char.DescendantAdded:Connect(function(obj)
        if states.AntiScript and 
           (obj:IsA("BodyVelocity") or obj:IsA("BodyGyro") or 
            obj:IsA("AlignPosition") or obj:IsA("AlignOrientation")) then
            obj:Destroy()
        end
    end)
end)

-- Initial update
updateStatus()

-- Make the UI look active with a slight glow animation
while true do
    local glow = math.sin(tick() * 2) * 0.1 + 0.2
    titleBarStroke.Transparency = glow
    task.wait(0.1)
end
