local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local runService = game:GetService("RunService")
local userInput = game:GetService("UserInputService")
local camera = workspace.CurrentCamera
local tweenService = game:GetService("TweenService")

local states = {
    Mode = "None",
    God = false,
    Freecam = false,
    Possess = false,
    AntiScript = false,
    GuiVisible = true
}

local config = {
    freecamSpeed = 2,
    freecamBoost = 6,
    deleteRadius = 25,
    gridSnap = 1,
    teleportTweenTime = 0.2,
    guiAnimSpeed = 0.25
}

local undoStack = {}
local draggingPart = nil
local highlight = nil
local possessTarget = nil
local vel = Vector3.zero

-- T·∫°o GUI v·ªõi phong c√°ch Liquid Glass
local gui = Instance.new("ScreenGui", player.PlayerGui)
gui.Name = "AdvancedAdminUI"
gui.ResetOnSpawn = false
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Background hi·ªáu ·ª©ng blur
local blurEffect = Instance.new("BlurEffect")
blurEffect.Size = 0
blurEffect.Parent = game.Lighting

-- T·∫°o frame ch√≠nh v·ªõi hi·ªáu ·ª©ng th·ªßy tinh
local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0, 400, 0, 500)
main.Position = UDim2.new(0, 40, 0.5, -250)
main.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
main.BackgroundTransparency = 0.15
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true
main.ClipsDescendants = true

-- Hi·ªáu ·ª©ng vi·ªÅn neon
local stroke = Instance.new("UIStroke", main)
stroke.Color = Color3.fromRGB(100, 180, 255)
stroke.Thickness = 2
stroke.Transparency = 0.3

-- Hi·ªáu ·ª©ng gradient
local gradient = Instance.new("UIGradient", main)
gradient.Rotation = 90
gradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 80, 150)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(20, 40, 80)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(10, 20, 40))
})
gradient.Transparency = NumberSequence.new(0.7)

local corner = Instance.new("UICorner", main)
corner.CornerRadius = UDim.new(0, 20)

-- Header v·ªõi hi·ªáu ·ª©ng th·ªßy tinh
local header = Instance.new("Frame", main)
header.Size = UDim2.new(1, 0, 0, 60)
header.BackgroundTransparency = 0.9
header.BorderSizePixel = 0

local headerCorner = Instance.new("UICorner", header)
headerCorner.CornerRadius = UDim.new(0, 20)

local headerGradient = Instance.new("UIGradient", header)
headerGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(100, 180, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(50, 100, 180))
})
headerGradient.Transparency = NumberSequence.new(0.8)

local title = Instance.new("TextLabel", header)
title.Size = UDim2.new(1, -40, 1, 0)
title.Position = UDim2.new(0, 20, 0, 0)
title.Text = "DINO CONTROLS"
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundTransparency = 1
title.TextXAlignment = Enum.TextXAlignment.Left

local titleGlow = Instance.new("TextLabel", header)
titleGlow.Size = title.Size
titleGlow.Position = title.Position
titleGlow.Text = title.Text
titleGlow.Font = title.Font
titleGlow.TextSize = title.TextSize
titleGlow.TextColor3 = Color3.fromRGB(100, 180, 255)
titleGlow.BackgroundTransparency = 1
titleGlow.TextXAlignment = Enum.TextXAlignment.Left
titleGlow.ZIndex = -1
titleGlow.TextTransparency = 0.7

-- N√∫t ·∫©n/hi·ªán GUI
local toggleButton = Instance.new("TextButton", gui)
toggleButton.Size = UDim2.new(0, 40, 0, 40)
toggleButton.Position = UDim2.new(1, -50, 0, 10)
toggleButton.Text = "‚óÄ"
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextSize = 18
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.BackgroundColor3 = Color3.fromRGB(20, 40, 80)
toggleButton.BackgroundTransparency = 0.3
toggleButton.AutoButtonColor = true

local toggleCorner = Instance.new("UICorner", toggleButton)
toggleCorner.CornerRadius = UDim.new(0, 20)

local toggleStroke = Instance.new("UIStroke", toggleButton)
toggleStroke.Color = Color3.fromRGB(100, 180, 255)
toggleStroke.Thickness = 2
toggleStroke.Transparency = 0.3

local toggleGradient = Instance.new("UIGradient", toggleButton)
toggleGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(50, 100, 180)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(30, 60, 120))
})

-- Status bar
local statusContainer = Instance.new("Frame", main)
statusContainer.Size = UDim2.new(1, -40, 0, 30)
statusContainer.Position = UDim2.new(0, 20, 0, 70)
statusContainer.BackgroundColor3 = Color3.fromRGB(20, 25, 35)
statusContainer.BackgroundTransparency = 0.6
statusContainer.BorderSizePixel = 0

local statusCorner = Instance.new("UICorner", statusContainer)
statusCorner.CornerRadius = UDim.new(0, 8)

local status = Instance.new("TextLabel", statusContainer)
status.Size = UDim2.new(1, -20, 1, 0)
status.Position = UDim2.new(0, 10, 0, 0)
status.BackgroundTransparency = 1
status.TextXAlignment = Enum.TextXAlignment.Left
status.Font = Enum.Font.Gotham
status.TextSize = 12
status.TextColor3 = Color3.fromRGB(200, 220, 255)
status.Text = "| READY | Mode: None | God: OFF | Freecam: OFF"

-- Container cho c√°c n√∫t
local buttonsContainer = Instance.new("ScrollingFrame", main)
buttonsContainer.Size = UDim2.new(1, -40, 1, -120)
buttonsContainer.Position = UDim2.new(0, 20, 0, 110)
buttonsContainer.BackgroundTransparency = 1
buttonsContainer.BorderSizePixel = 0
buttonsContainer.ScrollBarThickness = 4
buttonsContainer.CanvasSize = UDim2.new(0, 0, 0, 0)

local buttonsList = Instance.new("UIListLayout", buttonsContainer)
buttonsList.Padding = UDim.new(0, 10)
buttonsList.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- H√†m c·∫≠p nh·∫≠t status
local function updateStatus()
    status.Text = string.format("| Mode: %s | God: %s | Freecam: %s | Possess: %s |",
        states.Mode, states.God and "ON" or "OFF", 
        states.Freecam and "ON" or "OFF", states.Possess and "ON" or "OFF")
end

-- H√†m t·∫°o n√∫t v·ªõi hi·ªáu ·ª©ng liquid glass
local function createLiquidButton(text, color)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, 0, 0, 42)
    button.Text = text
    button.Font = Enum.Font.GothamSemibold
    button.TextSize = 14
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.BackgroundColor3 = color
    button.BackgroundTransparency = 0.4
    button.AutoButtonColor = true
    
    local corner = Instance.new("UICorner", button)
    corner.CornerRadius = UDim.new(0, 10)
    
    local stroke = Instance.new("UIStroke", button)
    stroke.Color = color
    stroke.Thickness = 2
    stroke.Transparency = 0.5
    
    local gradient = Instance.new("UIGradient", button)
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),
        ColorSequenceKeypoint.new(1, color)
    })
    gradient.Transparency = NumberSequence.new({
        NumberSequenceKeypoint.new(0, 0.7),
        NumberSequenceKeypoint.new(1, 0.3)
    })
    
    return button
end

-- T·∫°o c√°c n√∫t ch·ª©c nƒÉng
local modeButtons = {}
local function createModeButton(text, y, modeName, color, keybind)
    local button = createLiquidButton(text, color)
    button.Parent = buttonsContainer
    
    button.MouseButton1Click:Connect(function()
        states.Mode = states.Mode == modeName and "None" or modeName
        button.BackgroundTransparency = states.Mode == modeName and 0.2 or 0.4
        updateStatus()
    end)
    
    modeButtons[modeName] = button
    return button
end

-- C√°c n√∫t mode
createModeButton("üóëÔ∏è DELETE MODE (X)", 0, "Delete", Color3.fromRGB(220, 60, 60), Enum.KeyCode.X)
createModeButton("üöÄ MOVE MODE (C)", 0, "Move", Color3.fromRGB(60, 140, 220), Enum.KeyCode.C)
createModeButton("‚ú® TELEPORT MODE (T)", 0, "Teleport", Color3.fromRGB(220, 140, 60), Enum.KeyCode.T)

-- C√°c n√∫t ch·ª©c nƒÉng kh√°c
local function createFunctionButton(text, color, callback)
    local button = createLiquidButton(text, color)
    button.Parent = buttonsContainer
    
    button.MouseButton1Click:Connect(function()
        if callback then
            callback(button)
        end
    end)
    
    return button
end

local godButton = createFunctionButton("üõ°Ô∏è GOD MODE (G)", Color3.fromRGB(60, 180, 60), function(b)
    states.God = not states.God
    b.Text = states.God and "üõ°Ô∏è GOD MODE ON (G)" or "üõ°Ô∏è GOD MODE OFF (G)"
    updateStatus()
end)

local freecamButton = createFunctionButton("üëÅÔ∏è FREECAM (F)", Color3.fromRGB(180, 180, 60), function(b)
    states.Freecam = not states.Freecam
    b.Text = states.Freecam and "üëÅÔ∏è FREECAM ON (F)" or "üëÅÔ∏è FREECAM OFF (F)"
    
    if states.Freecam then
        camera.CameraType = Enum.CameraType.Scriptable
    else
        camera.CameraType = Enum.CameraType.Custom
        if player.Character then
            camera.CameraSubject = player.Character:FindFirstChild("Humanoid")
        end
    end
    updateStatus()
end)

local possessButton = createFunctionButton("üë§ POSSESS", Color3.fromRGB(140, 60, 200), function(b)
    states.Possess = not states.Possess
    b.Text = states.Possess and "üë§ POSSESS ON" or "üë§ POSSESS OFF"
    
    if not states.Possess then
        possessTarget = nil
        if player.Character then
            camera.CameraSubject = player.Character:FindFirstChild("Humanoid")
        end
    end
    updateStatus()
end)

local antiScriptButton = createFunctionButton("üõ°Ô∏è ANTI SCRIPT", Color3.fromRGB(60, 180, 120), function(b)
    states.AntiScript = not states.AntiScript
    b.Text = states.AntiScript and "üõ°Ô∏è ANTI SCRIPT ON" or "üõ°Ô∏è ANTI SCRIPT OFF"
end)

createFunctionButton("üí• DELETE NEARBY", Color3.fromRGB(220, 80, 80), function()
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then return end
    local root = player.Character.HumanoidRootPart
    
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and not obj:IsDescendantOf(player.Character) then
            if (obj.Position - root.Position).Magnitude <= config.deleteRadius then
                table.insert(undoStack, obj:Clone())
                obj:Destroy()
            end
        end
    end
end)

createFunctionButton("‚Ü©Ô∏è UNDO DELETE", Color3.fromRGB(80, 160, 220), function()
    local last = table.remove(undoStack)
    if last then
        last.Parent = workspace
    end
end)

-- C·∫≠p nh·∫≠t k√≠ch th∆∞·ªõc canvas
buttonsList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    buttonsContainer.CanvasSize = UDim2.new(0, 0, 0, buttonsList.AbsoluteContentSize.Y)
end)

-- H√†m ·∫©n/hi·ªán GUI v·ªõi animation
local function toggleGuiVisibility()
    states.GuiVisible = not states.GuiVisible
    
    if states.GuiVisible then
        toggleButton.Text = "‚óÄ"
        -- Hi·ªán GUI v·ªõi animation
        main:TweenSize(UDim2.new(0, 400, 0, 500), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, config.guiAnimSpeed, true)
        main:TweenPosition(UDim2.new(0, 40, 0.5, -250), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, config.guiAnimSpeed, true)
        -- TƒÉng blur effect
        tweenService:Create(blurEffect, TweenInfo.new(config.guiAnimSpeed), {Size = 12}):Play()
    else
        toggleButton.Text = "‚ñ∂"
        -- ·∫®n GUI v·ªõi animation
        main:TweenSize(UDim2.new(0, 0, 0, 500), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, config.guiAnimSpeed, true)
        main:TweenPosition(UDim2.new(0, -400, 0.5, -250), Enum.EasingDirection.Out, Enum.EasingStyle.Quart, config.guiAnimSpeed, true)
        -- Gi·∫£m blur effect
        tweenService:Create(blurEffect, TweenInfo.new(config.guiAnimSpeed), {Size = 0}):Play()
    end
end

-- K·∫øt n·ªëi n√∫t toggle
toggleButton.MouseButton1Click:Connect(toggleGuiVisibility)

-- C√°c h√†m v√† ch·ª©c nƒÉng c√≤n l·∫°i gi·ªØ nguy√™n...
local function getHighlight()
    if not highlight then
        highlight = Instance.new("Highlight")
        highlight.FillTransparency = 1
        highlight.OutlineColor = Color3.fromRGB(100, 180, 255)
        highlight.OutlineTransparency = 0
    end
    return highlight
end

local function teleportTo(position)
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end

    local root = char.HumanoidRootPart
    local goal = {CFrame = CFrame.new(position + Vector3.new(0, 3, 0))}

    local tween = tweenService:Create(root, TweenInfo.new(config.teleportTweenTime, Enum.EasingStyle.Quad), goal)
    tween:Play()
end

runService.RenderStepped:Connect(function(dt)
    if states.Freecam then
        local move = Vector3.zero
        local cf = camera.CFrame
        local look = cf.LookVector
        local right = cf.RightVector

        if userInput:IsKeyDown(Enum.KeyCode.W) then move = move + look end
        if userInput:IsKeyDown(Enum.KeyCode.S) then move = move - look end
        if userInput:IsKeyDown(Enum.KeyCode.D) then move = move + right end
        if userInput:IsKeyDown(Enum.KeyCode.A) then move = move - right end
        if userInput:IsKeyDown(Enum.KeyCode.E) then move = move + Vector3.new(0, 1, 0) end
        if userInput:IsKeyDown(Enum.KeyCode.Q) then move = move - Vector3.new(0, 1, 0) end

        local speed = config.freecamSpeed
        if userInput:IsKeyDown(Enum.KeyCode.LeftShift) then
            speed = config.freecamBoost
        elseif userInput:IsKeyDown(Enum.KeyCode.LeftControl) then
            speed = config.freecamSpeed * 0.5
        end

        vel = vel:Lerp(move * speed, 0.15)
        camera.CFrame = camera.CFrame + vel
    end

    if states.God and player.Character and player.Character:FindFirstChild("Humanoid") then
        local hum = player.Character.Humanoid
        hum.Health = hum.MaxHealth
        hum:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, false)
    end

    if draggingPart and states.Mode == "Move" then
        local pos = mouse.Hit.Position

        if config.gridSnap > 0 then
            pos = Vector3.new(
                math.round(pos.X / config.gridSnap) * config.gridSnap,
                math.round(pos.Y / config.gridSnap) * config.gridSnap,
                math.round(pos.Z / config.gridSnap) * config.gridSnap
            )
        end

        draggingPart.Position = pos
    end
end)

mouse.Button1Down:Connect(function()
    local t = mouse.Target
    if not t then return end

    if states.Possess then
        local m = t:FindFirstAncestorOfClass("Model")
        if m and m:FindFirstChild("Humanoid") then
            possessTarget = m
            camera.CameraSubject = m.Humanoid
        end

    elseif states.Mode == "Delete" and not t:IsDescendantOf(player.Character) then
        table.insert(undoStack, t:Clone())
        t:Destroy()

    elseif states.Mode == "Move" and t:IsA("BasePart") and not t:IsDescendantOf(player.Character) then
        draggingPart = t
        draggingPart.Anchored = true
        local h = getHighlight()
        h.Parent = t

    elseif states.Mode == "Teleport" then
        teleportTo(mouse.Hit.Position)
    end
end)

mouse.Button1Up:Connect(function()
    if draggingPart then
        draggingPart.Anchored = false
        if highlight then highlight.Parent = nil end
    end
    draggingPart = nil
end)

userInput.InputBegan:Connect(function(i, gp)
    if gp then return end

    if i.KeyCode == Enum.KeyCode.F then
        states.Freecam = not states.Freecam
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.G then
        states.God = not states.God
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.X then
        states.Mode = states.Mode == "Delete" and "None" or "Delete"
        if modeButtons["Delete"] then
            modeButtons["Delete"].BackgroundTransparency = states.Mode == "Delete" and 0.2 or 0.4
        end
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.C then
        states.Mode = states.Mode == "Move" and "None" or "Move"
        if modeButtons["Move"] then
            modeButtons["Move"].BackgroundTransparency = states.Mode == "Move" and 0.2 or 0.4
        end
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.T then
        states.Mode = states.Mode == "Teleport" and "None" or "Teleport"
        if modeButtons["Teleport"] then
            modeButtons["Teleport"].BackgroundTransparency = states.Mode == "Teleport" and 0.2 or 0.4
        end
        updateStatus()
    elseif i.KeyCode == Enum.KeyCode.H then
        -- Ph√≠m H ƒë·ªÉ toggle GUI
        toggleGuiVisibility()
    end
end)

player.CharacterAdded:Connect(function(char)
    char.DescendantAdded:Connect(function(obj)
        if states.AntiScript and 
           (obj:IsA("BodyVelocity") or obj:IsA("BodyGyro") or obj:IsA("AlignPosition") or obj:IsA("AlignOrientation")) then
            obj:Destroy()
        end
    end)
end)

-- C·∫≠p nh·∫≠t tr·∫°ng th√°i ban ƒë·∫ßu
updateStatus()
