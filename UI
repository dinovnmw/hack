-- FluentLite v4 - Premium, Gradient, Notifications
-- Modern UI Library with Dropdown & Notifs

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

local Library = {}
Library.Accent = Color3.fromRGB(0, 140, 255)
Library.Theme = {
    Main = Color3.fromRGB(20, 20, 20),
    Sidebar = Color3.fromRGB(28, 28, 28),
    Item = Color3.fromRGB(32, 32, 32),
    Text = Color3.fromRGB(240, 240, 240),
    SubText = Color3.fromRGB(160, 160, 160),
    Outline = Color3.fromRGB(50, 50, 50)
}

-- [UTILITY] --
local function Tween(obj, props, time)
    TweenService:Create(obj, TweenInfo.new(time or 0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), props):Play()
end

local function MakeDraggable(frame, dragHandle)
    local dragging, dragInput, dragStart, startPos
    dragHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = frame.Position
            input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
        end
    end)
    dragHandle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            Tween(frame, {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}, 0.05)
        end
    end)
end

-- [NOTIFICATION SYSTEM] --
local NotifHolder
function Library:Notify(title, text, duration)
    if not NotifHolder then return end
    local Notif = Instance.new("Frame")
    Notif.Size = UDim2.fromOffset(250, 60)
    Notif.Position = UDim2.new(1, 10, 1, -70) -- Start outside
    Notif.BackgroundColor3 = Library.Theme.Main
    Notif.BorderSizePixel = 0
    Notif.Parent = NotifHolder
    
    Instance.new("UICorner", Notif).CornerRadius = UDim.new(0, 8)
    Instance.new("UIStroke", Notif).Color = Library.Theme.Outline
    
    local Line = Instance.new("Frame", Notif)
    Line.Size = UDim2.new(0, 3, 1, -10)
    Line.Position = UDim2.fromOffset(5, 5)
    Line.BackgroundColor3 = Library.Accent
    Instance.new("UICorner", Line).CornerRadius = UDim.new(1,0)

    local T = Instance.new("TextLabel", Notif)
    T.Text = title
    T.Font = Enum.Font.GothamBold
    T.TextSize = 14
    T.TextColor3 = Library.Theme.Text
    T.Position = UDim2.fromOffset(15, 8)
    T.Size = UDim2.new(1, -20, 0, 20)
    T.TextXAlignment = Enum.TextXAlignment.Left
    T.BackgroundTransparency = 1

    local D = Instance.new("TextLabel", Notif)
    D.Text = text
    D.Font = Enum.Font.Gotham
    D.TextSize = 12
    D.TextColor3 = Library.Theme.SubText
    D.Position = UDim2.fromOffset(15, 28)
    D.Size = UDim2.new(1, -20, 0, 20)
    D.TextXAlignment = Enum.TextXAlignment.Left
    D.BackgroundTransparency = 1

    -- Anim
    Tween(Notif, {Position = UDim2.new(1, -260, 1, -70 - (#NotifHolder:GetChildren()-1)*65)}, 0.5)
    
    task.delay(duration or 3, function()
        Tween(Notif, {Position = UDim2.new(1, 20, Notif.Position.Y.Scale, Notif.Position.Y.Offset)}, 0.5)
        task.wait(0.5)
        Notif:Destroy()
    end)
end

function Library:CreateWindow(settings)
    local Window = {}
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "FluentLiteV4"
    if pcall(function() ScreenGui.Parent = CoreGui end) then else ScreenGui.Parent = LocalPlayer.PlayerGui end

    NotifHolder = Instance.new("Frame", ScreenGui)
    NotifHolder.Size = UDim2.fromScale(1,1)
    NotifHolder.BackgroundTransparency = 1
    NotifHolder.Position = UDim2.new(0,0,0, -20) -- Offset slightly up
    
    -- [MAIN UI] --
    local Main = Instance.new("Frame", ScreenGui)
    Main.Size = UDim2.fromOffset(580, 400)
    Main.Position = UDim2.fromScale(0.5, 0.5)
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    Main.BackgroundColor3 = Library.Theme.Main
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)
    
    -- Drop Shadow (Fake)
    local Shadow = Instance.new("ImageLabel", Main)
    Shadow.Size = UDim2.new(1, 40, 1, 40)
    Shadow.Position = UDim2.fromOffset(-20, -20)
    Shadow.Image = "rbxassetid://6015897843"
    Shadow.ImageColor3 = Color3.new(0,0,0)
    Shadow.ImageTransparency = 0.4
    Shadow.BackgroundTransparency = 1
    Shadow.ZIndex = -1
    Shadow.ScaleType = Enum.ScaleType.Slice
    Shadow.SliceCenter = Rect.new(49, 49, 450, 450)

    -- Gradient Outline
    local Stroke = Instance.new("UIStroke", Main)
    Stroke.Thickness = 1
    Stroke.Color = Color3.fromRGB(255, 255, 255)
    local StrokeGrad = Instance.new("UIGradient", Stroke)
    StrokeGrad.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Library.Accent),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(60,60,60))
    }
    StrokeGrad.Rotation = 45

    local TopBar = Instance.new("Frame", Main)
    TopBar.Size = UDim2.new(1,0,0,40)
    TopBar.BackgroundTransparency = 1
    MakeDraggable(Main, TopBar)

    local Title = Instance.new("TextLabel", TopBar)
    Title.Text = settings.Title or "FluentLite v4"
    Title.Font = Enum.Font.GothamBold
    Title.TextColor3 = Library.Theme.Text
    Title.TextSize = 16
    Title.Position = UDim2.fromOffset(15,0)
    Title.Size = UDim2.new(0,200,1,0)
    Title.BackgroundTransparency = 1
    Title.TextXAlignment = Enum.TextXAlignment.Left

    local Sidebar = Instance.new("ScrollingFrame", Main)
    Sidebar.Size = UDim2.new(0, 140, 1, -50)
    Sidebar.Position = UDim2.fromOffset(10, 45)
    Sidebar.BackgroundColor3 = Library.Theme.Sidebar
    Sidebar.ScrollBarThickness = 0
    Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 8)
    local TabList = Instance.new("UIListLayout", Sidebar)
    TabList.Padding = UDim.new(0, 6)
    Instance.new("UIPadding", Sidebar).PaddingTop = UDim.new(0,8)
    
    local PageHolder = Instance.new("Frame", Main)
    PageHolder.Size = UDim2.new(1, -165, 1, -50)
    PageHolder.Position = UDim2.fromOffset(160, 45)
    PageHolder.BackgroundTransparency = 1

    function Window:CreateTab(name)
        local Tab = {}
        local TabBtn = Instance.new("TextButton", Sidebar)
        TabBtn.Text = name
        TabBtn.Size = UDim2.new(1, 0, 0, 32)
        TabBtn.BackgroundTransparency = 1
        TabBtn.TextColor3 = Library.Theme.SubText
        TabBtn.Font = Enum.Font.GothamMedium
        TabBtn.TextSize = 13
        
        local Page = Instance.new("ScrollingFrame", PageHolder)
        Page.Size = UDim2.fromScale(1,1)
        Page.BackgroundTransparency = 1
        Page.ScrollBarThickness = 2
        Page.ScrollBarImageColor3 = Library.Accent
        Page.Visible = false
        local PageList = Instance.new("UIListLayout", Page)
        PageList.Padding = UDim.new(0, 8)
        PageList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() Page.CanvasSize = UDim2.new(0,0,0,PageList.AbsoluteContentSize.Y+10) end)

        TabBtn.MouseButton1Click:Connect(function()
            for _,v in pairs(Sidebar:GetChildren()) do if v:IsA("TextButton") then Tween(v,{TextColor3=Library.Theme.SubText}) end end
            Tween(TabBtn, {TextColor3 = Library.Theme.Text})
            for _,p in pairs(PageHolder:GetChildren()) do p.Visible = false end
            Page.Visible = true
            Page.Position = UDim2.fromOffset(0, 10)
            Tween(Page, {Position = UDim2.new(0,0,0,0)}, 0.3)
        end)

        function Tab:AddButton(text, callback)
            local Btn = Instance.new("TextButton", Page)
            Btn.Text = text
            Btn.Size = UDim2.new(1, -5, 0, 38)
            Btn.BackgroundColor3 = Library.Theme.Item
            Btn.TextColor3 = Library.Theme.Text
            Btn.Font = Enum.Font.Gotham
            Btn.TextSize = 14
            Btn.AutoButtonColor = false
            Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 6)
            
            Btn.MouseEnter:Connect(function() Tween(Btn, {BackgroundColor3 = Color3.fromRGB(45,45,45)}) end)
            Btn.MouseLeave:Connect(function() Tween(Btn, {BackgroundColor3 = Library.Theme.Item}) end)
            Btn.MouseButton1Click:Connect(function()
                Tween(Btn, {TextSize = 12}, 0.1)
                task.wait(0.1)
                Tween(Btn, {TextSize = 14}, 0.1)
                if callback then callback() end
            end)
        end

        function Tab:AddToggle(text, default, callback)
            local Toggled = default or false
            local Frame = Instance.new("TextButton", Page)
            Frame.Text = ""
            Frame.BackgroundColor3 = Library.Theme.Item
            Frame.Size = UDim2.new(1, -5, 0, 38)
            Frame.AutoButtonColor = false
            Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 6)
            
            local Lbl = Instance.new("TextLabel", Frame)
            Lbl.Text = text
            Lbl.Font = Enum.Font.Gotham
            Lbl.TextColor3 = Library.Theme.Text
            Lbl.TextSize = 14
            Lbl.BackgroundTransparency = 1
            Lbl.Position = UDim2.fromOffset(10,0)
            Lbl.Size = UDim2.new(1,-60,1,0)
            Lbl.TextXAlignment = Enum.TextXAlignment.Left

            local Switch = Instance.new("Frame", Frame)
            Switch.Size = UDim2.fromOffset(36, 18)
            Switch.Position = UDim2.new(1, -46, 0.5, -9)
            Switch.BackgroundColor3 = Toggled and Library.Accent or Color3.fromRGB(50,50,50)
            Instance.new("UICorner", Switch).CornerRadius = UDim.new(1,0)
            
            local Dot = Instance.new("Frame", Switch)
            Dot.Size = UDim2.fromOffset(14,14)
            Dot.Position = Toggled and UDim2.new(1,-16,0.5,-7) or UDim2.new(0,2,0.5,-7)
            Dot.BackgroundColor3 = Color3.new(1,1,1)
            Instance.new("UICorner", Dot).CornerRadius = UDim.new(1,0)

            Frame.MouseButton1Click:Connect(function()
                Toggled = not Toggled
                Tween(Switch, {BackgroundColor3 = Toggled and Library.Accent or Color3.fromRGB(50,50,50)})
                Tween(Dot, {Position = Toggled and UDim2.new(1,-16,0.5,-7) or UDim2.new(0,2,0.5,-7)})
                if callback then callback(Toggled) end
            end)
        end

        function Tab:AddDropdown(text, options, callback)
            local Drop = Instance.new("Frame", Page)
            Drop.BackgroundColor3 = Library.Theme.Item
            Drop.Size = UDim2.new(1, -5, 0, 38) -- Default Height
            Drop.ClipsDescendants = true
            Instance.new("UICorner", Drop).CornerRadius = UDim.new(0, 6)
            
            local Btn = Instance.new("TextButton", Drop)
            Btn.Text = text .. " [V]"
            Btn.Size = UDim2.new(1, 0, 0, 38)
            Btn.BackgroundTransparency = 1
            Btn.TextColor3 = Library.Theme.Text
            Btn.Font = Enum.Font.Gotham
            Btn.TextSize = 14
            Btn.TextXAlignment = Enum.TextXAlignment.Left
            Instance.new("UIPadding", Btn).PaddingLeft = UDim.new(0, 10)

            local Opened = false
            local ListHeight = #options * 30
            
            Btn.MouseButton1Click:Connect(function()
                Opened = not Opened
                Tween(Drop, {Size = Opened and UDim2.new(1, -5, 0, 38 + ListHeight + 5) or UDim2.new(1, -5, 0, 38)})
                Btn.Text = text .. (Opened and " [^]" or " [V]")
            end)

            for i, v in ipairs(options) do
                local Opt = Instance.new("TextButton", Drop)
                Opt.Text = v
                Opt.Size = UDim2.new(1, -10, 0, 25)
                Opt.Position = UDim2.fromOffset(5, 38 + (i-1)*30)
                Opt.BackgroundColor3 = Library.Theme.Sidebar
                Opt.TextColor3 = Library.Theme.SubText
                Opt.Font = Enum.Font.Gotham
                Opt.TextSize = 13
                Instance.new("UICorner", Opt).CornerRadius = UDim.new(0, 4)
                
                Opt.MouseButton1Click:Connect(function()
                    Opened = false
                    Tween(Drop, {Size = UDim2.new(1, -5, 0, 38)})
                    Btn.Text = text .. " : " .. v
                    if callback then callback(v) end
                end)
            end
        end

        return Tab
    end
    return Window
end

-- Example:
-- local win = Library:CreateWindow({Title = "FluentLite v4"})
-- local tab = win:CreateTab("Main")
-- tab:AddButton("Hello", function() Library:Notify("Hi", "Welcome to v4", 3) end)
-- tab:AddDropdown("Select Weapon", {"AK-47", "M4A1", "AWP"}, function(val) print(val) end)

return Library
