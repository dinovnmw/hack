-- Fluent UI Roblox Library - Upgraded Version
-- Super beautiful interface, clear layout, smooth animations, many functions like RayField.
-- Added: Sections, Slider, ColorPicker, TextInput, Keybind, more animations (fade, scale), full config system (save/load/import).
-- Toggle UI icon, draggable, gradients, notifications.
-- Full code with comments.

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

local Fluent = {}  -- Main library table
Fluent.Accent = Color3.fromRGB(0, 140, 255)  -- Accent color
Fluent.Theme = {  -- Theme colors
    Main = Color3.fromRGB(20, 20, 20),
    Sidebar = Color3.fromRGB(28, 28, 28),
    Item = Color3.fromRGB(32, 32, 32),
    Text = Color3.fromRGB(240, 240, 240),
    SubText = Color3.fromRGB(160, 160, 160),
    Outline = Color3.fromRGB(50, 50, 50)
}
Fluent.ConfigFolder = "FluentConfigs"  -- Config folder
Fluent.Configs = {}  -- Stored config values

-- Utility: Tween function for animations
local function Tween(obj, props, time, style)
    TweenService:Create(obj, TweenInfo.new(time or 0.3, style or Enum.EasingStyle.Quart, Enum.EasingDirection.Out), props):Play()
end

-- Utility: Make frame draggable
local function MakeDraggable(frame, dragHandle)
    local dragging, dragInput, dragStart, startPos
    dragHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = frame.Position
            input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
        end
    end)
    dragHandle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            Tween(frame, {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}, 0.05, Enum.EasingStyle.Linear)
        end
    end)
end

-- Notification System with animations
local NotifHolder
function Fluent:Notify(options)
    if not NotifHolder then return end
    local title = options.Title or "Notification"
    local text = options.Content or ""
    local duration = options.Duration or 3
    local Notif = Instance.new("Frame")
    Notif.Size = UDim2.fromOffset(250, 60)
    Notif.Position = UDim2.new(1, 10, 1, -70)
    Notif.BackgroundColor3 = Fluent.Theme.Main
    Notif.BorderSizePixel = 0
    Notif.Parent = NotifHolder
    Notif.Transparency = 1  -- Start transparent for fade in
    Instance.new("UICorner", Notif).CornerRadius = UDim.new(0, 8)
    Instance.new("UIStroke", Notif).Color = Fluent.Theme.Outline
    local Line = Instance.new("Frame", Notif)
    Line.Size = UDim2.new(0, 3, 1, -10)
    Line.Position = UDim2.fromOffset(5, 5)
    Line.BackgroundColor3 = Fluent.Accent
    Instance.new("UICorner", Line).CornerRadius = UDim.new(1,0)
    local T = Instance.new("TextLabel", Notif)
    T.Text = title
    T.Font = Enum.Font.GothamBold
    T.TextSize = 14
    T.TextColor3 = Fluent.Theme.Text
    T.Position = UDim2.fromOffset(15, 8)
    T.Size = UDim2.new(1, -20, 0, 20)
    T.TextXAlignment = Enum.TextXAlignment.Left
    T.BackgroundTransparency = 1
    local D = Instance.new("TextLabel", Notif)
    D.Text = text
    D.Font = Enum.Font.Gotham
    D.TextSize = 12
    D.TextColor3 = Fluent.Theme.SubText
    D.Position = UDim2.fromOffset(15, 28)
    D.Size = UDim2.new(1, -20, 0, 20)
    D.TextXAlignment = Enum.TextXAlignment.Left
    D.BackgroundTransparency = 1
    -- Animate in: slide + fade
    Tween(Notif, {Position = UDim2.new(1, -260, 1, -70 - (#NotifHolder:GetChildren()-1)*65)}, 0.5)
    Tween(Notif, {Transparency = 0}, 0.5)
    task.delay(duration, function()
        Tween(Notif, {Position = UDim2.new(1, 20, Notif.Position.Y.Scale, Notif.Position.Y.Offset)}, 0.5)
        Tween(Notif, {Transparency = 1}, 0.5)
        task.wait(0.5)
        Notif:Destroy()
    end)
end

-- Config System: Save, Load, Import
function Fluent:SaveConfig(configName)
    local config = {}
    for flag, value in pairs(Fluent.Configs) do
        config[flag] = value
    end
    writefile(Fluent.ConfigFolder .. "/" .. configName .. ".json", HttpService:JSONEncode(config))
    Fluent:Notify({Title = "Config", Content = "Saved " .. configName})
end

function Fluent:LoadConfig(configName)
    if isfile(Fluent.ConfigFolder .. "/" .. configName .. ".json") then
        local data = HttpService:JSONDecode(readfile(Fluent.ConfigFolder .. "/" .. configName .. ".json"))
        for flag, value in pairs(data) do
            Fluent.Configs[flag] = value
            -- Trigger callbacks if needed (assuming elements have Set functions)
        end
        Fluent:Notify({Title = "Config", Content = "Loaded " .. configName})
    end
end

function Fluent:ImportConfig(jsonString)
    local data = HttpService:JSONDecode(jsonString)
    for flag, value in pairs(data) do
        Fluent.Configs[flag] = value
    end
    Fluent:Notify({Title = "Config", Content = "Imported config"})
end

-- Create Window with clear layout and animations
function Fluent:CreateWindow(options)
    local Window = {}
    local title = options.Title or "Fluent UI"
    local size = options.Size or UDim2.fromOffset(580, 400)
    local minimizeKey = options.MinimizeKey or Enum.KeyCode.RightShift
    local configSaving = options.ConfigurationSaving or {Enabled = false, FileName = "config"}

    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "FluentUI"
    if pcall(function() ScreenGui.Parent = CoreGui end) then else ScreenGui.Parent = LocalPlayer.PlayerGui end
    NotifHolder = Instance.new("Frame", ScreenGui)
    NotifHolder.Size = UDim2.fromScale(1,1)
    NotifHolder.BackgroundTransparency = 1
    NotifHolder.Position = UDim2.new(0,0,0, -20)

    local Main = Instance.new("Frame", ScreenGui)
    Main.Size = size
    Main.Position = UDim2.fromScale(0.5, 0.5)
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    Main.BackgroundColor3 = Fluent.Theme.Main
    Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 10)
    Main.Visible = false  -- Start hidden for fade in
    Main.Transparency = 1

    -- Shadow for beauty
    local Shadow = Instance.new("ImageLabel", Main)
    Shadow.Size = UDim2.new(1, 40, 1, 40)
    Shadow.Position = UDim2.fromOffset(-20, -20)
    Shadow.Image = "rbxassetid://6015897843"
    Shadow.ImageColor3 = Color3.new(0,0,0)
    Shadow.ImageTransparency = 0.4
    Shadow.BackgroundTransparency = 1
    Shadow.ZIndex = -1
    Shadow.ScaleType = Enum.ScaleType.Slice
    Shadow.SliceCenter = Rect.new(49, 49, 450, 450)

    -- Gradient Stroke for beautiful outline
    local Stroke = Instance.new("UIStroke", Main)
    Stroke.Thickness = 1
    Stroke.Color = Color3.fromRGB(255, 255, 255)
    local StrokeGrad = Instance.new("UIGradient", Stroke)
    StrokeGrad.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Fluent.Accent),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(60,60,60))
    }
    StrokeGrad.Rotation = 45

    local TopBar = Instance.new("Frame", Main)
    TopBar.Size = UDim2.new(1,0,0,40)
    TopBar.BackgroundTransparency = 1
    MakeDraggable(Main, TopBar)

    local Title = Instance.new("TextLabel", TopBar)
    Title.Text = title
    Title.Font = Enum.Font.GothamBold
    Title.TextColor3 = Fluent.Theme.Text
    Title.TextSize = 16
    Title.Position = UDim2.fromOffset(15,0)
    Title.Size = UDim2.new(0,200,1,0)
    Title.BackgroundTransparency = 1
    Title.TextXAlignment = Enum.TextXAlignment.Left

    -- Toggle Button with animation
    local ToggleBtn = Instance.new("TextButton", TopBar)
    ToggleBtn.Text = "X"
    ToggleBtn.Size = UDim2.fromOffset(30, 30)
    ToggleBtn.Position = UDim2.new(1, -40, 0, 5)
    ToggleBtn.BackgroundTransparency = 1
    ToggleBtn.TextColor3 = Fluent.Theme.Text
    ToggleBtn.Font = Enum.Font.GothamBold
    ToggleBtn.TextSize = 14
    ToggleBtn.MouseButton1Click:Connect(function()
        if Main.Visible then
            Tween(Main, {Transparency = 1}, 0.3)
            task.wait(0.3)
            Main.Visible = false
        else
            Main.Visible = true
            Tween(Main, {Transparency = 0}, 0.3)
        end
    end)

    -- Keybind for toggle
    UserInputService.InputBegan:Connect(function(input)
        if input.KeyCode == minimizeKey then
            ToggleBtn:SimulateClick()  -- Simulate toggle
        end
    end)

    local Sidebar = Instance.new("ScrollingFrame", Main)
    Sidebar.Size = UDim2.new(0, 140, 1, -50)
    Sidebar.Position = UDim2.fromOffset(10, 45)
    Sidebar.BackgroundColor3 = Fluent.Theme.Sidebar
    Sidebar.ScrollBarThickness = 0
    Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 8)
    local TabList = Instance.new("UIListLayout", Sidebar)
    TabList.Padding = UDim.new(0, 6)
    Instance.new("UIPadding", Sidebar).PaddingTop = UDim.new(0,8)

    local PageHolder = Instance.new("Frame", Main)
    PageHolder.Size = UDim2.new(1, -165, 1, -50)
    PageHolder.Position = UDim2.fromOffset(160, 45)
    PageHolder.BackgroundTransparency = 1

    -- Create Tab with fade animation
    function Window:AddTab(options)
        local Tab = {}
        local name = options.Title or "Tab"
        local icon = options.Icon or ""

        local TabBtn = Instance.new("TextButton", Sidebar)
        TabBtn.Text = icon .. " " .. name
        TabBtn.Size = UDim2.new(1, 0, 0, 32)
        TabBtn.BackgroundTransparency = 1
        TabBtn.TextColor3 = Fluent.Theme.SubText
        TabBtn.Font = Enum.Font.GothamMedium
        TabBtn.TextSize = 13
        TabBtn.Transparency = 1  -- For animation
        Tween(TabBtn, {Transparency = 0}, 0.5)  -- Fade in

        local Page = Instance.new("ScrollingFrame", PageHolder)
        Page.Size = UDim2.fromScale(1,1)
        Page.BackgroundTransparency = 1
        Page.ScrollBarThickness = 2
        Page.ScrollBarImageColor3 = Fluent.Accent
        Page.Visible = false
        local PageList = Instance.new("UIListLayout", Page)
        PageList.Padding = UDim.new(0, 8)
        PageList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() Page.CanvasSize = UDim2.new(0,0,0,PageList.AbsoluteContentSize.Y+10) end)

        TabBtn.MouseButton1Click:Connect(function()
            for _,v in pairs(Sidebar:GetChildren()) do if v:IsA("TextButton") then Tween(v,{TextColor3=Fluent.Theme.SubText}) end end
            Tween(TabBtn, {TextColor3 = Fluent.Theme.Text})
            for _,p in pairs(PageHolder:GetChildren()) do 
                if p.Visible then Tween(p, {Transparency = 1}, 0.3) end
                p.Visible = false 
            end
            Page.Visible = true
            Page.Transparency = 1
            Tween(Page, {Transparency = 0}, 0.3)
            Page.Position = UDim2.fromOffset(0, 10)
            Tween(Page, {Position = UDim2.new(0,0,0,0)}, 0.3)
        end)

        -- Add Section for clear layout
        function Tab:AddSection(name)
            local Section = Instance.new("Frame", Page)
            Section.Size = UDim2.new(1, -5, 0, 0)
            Section.BackgroundTransparency = 1
            local Title = Instance.new("TextLabel", Section)
            Title.Text = name
            Title.Font = Enum.Font.GothamBold
            Title.TextColor3 = Fluent.Theme.Text
            Title.TextSize = 15
            Title.Size = UDim2.new(1,0,0,25)
            Title.BackgroundTransparency = 1
            Title.TextXAlignment = Enum.TextXAlignment.Left
            local SectionList = Instance.new("UIListLayout", Section)
            SectionList.Padding = UDim.new(0, 5)
            SectionList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                Section.Size = UDim2.new(1, -5, 0, SectionList.AbsoluteContentSize.Y + 10)
            end)
            return Section
        end

        -- Add Button with scale animation
        function Tab:AddButton(options)
            local text = options.Name or "Button"
            local callback = options.Callback or function() end
            local Btn = Instance.new("TextButton", Page)
            Btn.Text = text
            Btn.Size = UDim2.new(1, -5, 0, 38)
            Btn.BackgroundColor3 = Fluent.Theme.Item
            Btn.TextColor3 = Fluent.Theme.Text
            Btn.Font = Enum.Font.Gotham
            Btn.TextSize = 14
            Btn.AutoButtonColor = false
            Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 6)
            Btn.MouseEnter:Connect(function() Tween(Btn, {BackgroundColor3 = Color3.fromRGB(45,45,45)}) end)
            Btn.MouseLeave:Connect(function() Tween(Btn, {BackgroundColor3 = Fluent.Theme.Item}) end)
            Btn.MouseButton1Click:Connect(function()
                Tween(Btn, {Size = UDim2.new(1, -5, 0, 35)}, 0.1)  -- Scale down
                task.wait(0.1)
                Tween(Btn, {Size = UDim2.new(1, -5, 0, 38)}, 0.1)  -- Scale up
                callback()
            end)
            return Btn
        end

        -- Add Toggle with smooth animation
        function Tab:AddToggle(options)
            local text = options.Name or "Toggle"
            local default = options.Default or false
            local flag = options.Flag or text
            local callback = options.Callback or function() end
            local Toggled = default
            Fluent.Configs[flag] = Toggled
            local Frame = Instance.new("TextButton", Page)
            Frame.Text = ""
            Frame.BackgroundColor3 = Fluent.Theme.Item
            Frame.Size = UDim2.new(1, -5, 0, 38)
            Frame.AutoButtonColor = false
            Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 6)
            local Lbl = Instance.new("TextLabel", Frame)
            Lbl.Text = text
            Lbl.Font = Enum.Font.Gotham
            Lbl.TextColor3 = Fluent.Theme.Text
            Lbl.TextSize = 14
            Lbl.BackgroundTransparency = 1
            Lbl.Position = UDim2.fromOffset(10,0)
            Lbl.Size = UDim2.new(1,-60,1,0)
            Lbl.TextXAlignment = Enum.TextXAlignment.Left
            local Switch = Instance.new("Frame", Frame)
            Switch.Size = UDim2.fromOffset(36, 18)
            Switch.Position = UDim2.new(1, -46, 0.5, -9)
            Switch.BackgroundColor3 = Toggled and Fluent.Accent or Color3.fromRGB(50,50,50)
            Instance.new("UICorner", Switch).CornerRadius = UDim.new(1,0)
            local Dot = Instance.new("Frame", Switch)
            Dot.Size = UDim2.fromOffset(14,14)
            Dot.Position = Toggled and UDim2.new(1,-16,0.5,-7) or UDim2.new(0,2,0.5,-7)
            Dot.BackgroundColor3 = Color3.new(1,1,1)
            Instance.new("UICorner", Dot).CornerRadius = UDim.new(1,0)
            Frame.MouseButton1Click:Connect(function()
                Toggled = not Toggled
                Fluent.Configs[flag] = Toggled
                Tween(Switch, {BackgroundColor3 = Toggled and Fluent.Accent or Color3.fromRGB(50,50,50)}, 0.2)
                Tween(Dot, {Position = Toggled and UDim2.new(1,-16,0.5,-7) or UDim2.new(0,2,0.5,-7)}, 0.2)
                callback(Toggled)
            end)
            return {Set = function(val) Toggled = val; Fluent.Configs[flag] = val; Tween(Switch, {BackgroundColor3 = val and Fluent.Accent or Color3.fromRGB(50,50,50)}); Tween(Dot, {Position = val and UDim2.new(1,-16,0.5,-7) or UDim2.new(0,2,0.5,-7)}) end}
        end

        -- Add Dropdown with expand animation
        function Tab:AddDropdown(options)
            local text = options.Name or "Dropdown"
            local values = options.Options or {}
            local default = options.Default or values[1]
            local flag = options.Flag or text
            local callback = options.Callback or function() end
            local Selected = default
            Fluent.Configs[flag] = Selected
            local Drop = Instance.new("Frame", Page)
            Drop.BackgroundColor3 = Fluent.Theme.Item
            Drop.Size = UDim2.new(1, -5, 0, 38)
            Drop.ClipsDescendants = true
            Instance.new("UICorner", Drop).CornerRadius = UDim.new(0, 6)
            local Btn = Instance.new("TextButton", Drop)
            Btn.Text = text .. ": " .. Selected .. " [V]"
            Btn.Size = UDim2.new(1, 0, 0, 38)
            Btn.BackgroundTransparency = 1
            Btn.TextColor3 = Fluent.Theme.Text
            Btn.Font = Enum.Font.Gotham
            Btn.TextSize = 14
            Btn.TextXAlignment = Enum.TextXAlignment.Left
            Instance.new("UIPadding", Btn).PaddingLeft = UDim.new(0, 10)
            local Opened = false
            local ListHeight = #values * 30
            Btn.MouseButton1Click:Connect(function()
                Opened = not Opened
                Tween(Drop, {Size = Opened and UDim2.new(1, -5, 0, 38 + ListHeight + 5) or UDim2.new(1, -5, 0, 38)}, 0.4, Enum.EasingStyle.Quint)
                Btn.Text = text .. ": " .. Selected .. (Opened and " [^]" or " [V]")
            end)
            for i, v in ipairs(values) do
                local Opt = Instance.new("TextButton", Drop)
                Opt.Text = v
                Opt.Size = UDim2.new(1, -10, 0, 25)
                Opt.Position = UDim2.fromOffset(5, 38 + (i-1)*30)
                Opt.BackgroundColor3 = Fluent.Theme.Sidebar
                Opt.TextColor3 = Fluent.Theme.SubText
                Opt.Font = Enum.Font.Gotham
                Opt.TextSize = 13
                Instance.new("UICorner", Opt).CornerRadius = UDim.new(0, 4)
                Opt.MouseEnter:Connect(function() Tween(Opt, {BackgroundColor3 = Color3.fromRGB(40,40,40)}) end)
                Opt.MouseLeave:Connect(function() Tween(Opt, {BackgroundColor3 = Fluent.Theme.Sidebar}) end)
                Opt.MouseButton1Click:Connect(function()
                    Opened = false
                    Tween(Drop, {Size = UDim2.new(1, -5, 0, 38)}, 0.4, Enum.EasingStyle.Quint)
                    Selected = v
                    Fluent.Configs[flag] = v
                    Btn.Text = text .. ": " .. v .. " [V]"
                    callback(v)
                end)
            end
            return {Set = function(val) Selected = val; Btn.Text = text .. ": " .. val .. " [V]" end}
        end

        -- Add Slider with drag animation
        function Tab:AddSlider(options)
            local text = options.Name or "Slider"
            local min = options.Min or 0
            local max = options.Max or 100
            local default = options.Default or min
            local flag = options.Flag or text
            local callback = options.Callback or function() end
            local Value = default
            Fluent.Configs[flag] = Value
            local Frame = Instance.new("Frame", Page)
            Frame.BackgroundColor3 = Fluent.Theme.Item
            Frame.Size = UDim2.new(1, -5, 0, 50)
            Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 6)
            local Lbl = Instance.new("TextLabel", Frame)
            Lbl.Text = text .. ": " .. Value
            Lbl.Font = Enum.Font.Gotham
            Lbl.TextColor3 = Fluent.Theme.Text
            Lbl.TextSize = 14
            Lbl.BackgroundTransparency = 1
            Lbl.Position = UDim2.fromOffset(10,5)
            Lbl.Size = UDim2.new(1,-20,0,20)
            Lbl.TextXAlignment = Enum.TextXAlignment.Left
            local SliderBar = Instance.new("Frame", Frame)
            SliderBar.Size = UDim2.new(1, -20, 0, 6)
            SliderBar.Position = UDim2.fromOffset(10, 30)
            SliderBar.BackgroundColor3 = Color3.fromRGB(50,50,50)
            Instance.new("UICorner", SliderBar).CornerRadius = UDim.new(1,0)
            local Fill = Instance.new("Frame", SliderBar)
            Fill.Size = UDim2.new((Value - min)/(max - min), 0, 1, 0)
            Fill.BackgroundColor3 = Fluent.Accent
            Instance.new("UICorner", Fill).CornerRadius = UDim.new(1,0)
            local dragging = false
            SliderBar.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                    Tween(SliderBar, {BackgroundColor3 = Color3.fromRGB(60,60,60)}, 0.2)
                end
            end)
            SliderBar.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = false
                    Tween(SliderBar, {BackgroundColor3 = Color3.fromRGB(50,50,50)}, 0.2)
                end
            end)
            UserInputService.InputChanged:Connect(function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local relativeX = math.clamp((input.Position.X - SliderBar.AbsolutePosition.X) / SliderBar.AbsoluteSize.X, 0, 1)
                    Value = math.floor(min + relativeX * (max - min))
                    Fluent.Configs[flag] = Value
                    Tween(Fill, {Size = UDim2.new(relativeX, 0, 1, 0)}, 0.1)
                    Lbl.Text = text .. ": " .. Value
                    callback(Value)
                end
            end)
            return {Set = function(val) Value = math.clamp(val, min, max); Tween(Fill, {Size = UDim2.new((Value - min)/(max - min), 0, 1, 0)}, 0.1); Lbl.Text = text .. ": " .. Value end}
        end

        -- Add ColorPicker with expand and color animation
        function Tab:AddColorPicker(options)
            local text = options.Name or "ColorPicker"
            local default = options.Default or Color3.fromRGB(255,255,255)
            local flag = options.Flag or text
            local callback = options.Callback or function() end
            local Color = default
            Fluent.Configs[flag] = Color
            local Frame = Instance.new("Frame", Page)
            Frame.BackgroundColor3 = Fluent.Theme.Item
            Frame.Size = UDim2.new(1, -5, 0, 38)
            Frame.ClipsDescendants = true
            Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 6)
            local Lbl = Instance.new("TextLabel", Frame)
            Lbl.Text = text
            Lbl.Font = Enum.Font.Gotham
            Lbl.TextColor3 = Fluent.Theme.Text
            Lbl.TextSize = 14
            Lbl.BackgroundTransparency = 1
            Lbl.Position = UDim2.fromOffset(10,0)
            Lbl.Size = UDim2.new(1,-60,1,0)
            Lbl.TextXAlignment = Enum.TextXAlignment.Left
            local Preview = Instance.new("Frame", Frame)
            Preview.Size = UDim2.fromOffset(20, 20)
            Preview.Position = UDim2.new(1, -40, 0.5, -10)
            Preview.BackgroundColor3 = Color
            Instance.new("UICorner", Preview).CornerRadius = UDim.new(0,4)
            local Picker = Instance.new("ImageLabel", Frame)
            Picker.Size = UDim2.new(1, -10, 0, 150)
            Picker.Position = UDim2.new(0,5,1,5)
            Picker.BackgroundColor3 = Color3.fromRGB(255,255,255)
            Picker.Image = "rbxassetid://1433361654"  -- Placeholder color wheel
            Picker.Visible = false
            Instance.new("UICorner", Picker).CornerRadius = UDim.new(0,6)
            local Opened = false
            Frame.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    Opened = not Opened
                    Picker.Visible = Opened
                    Tween(Frame, {Size = Opened and UDim2.new(1,-5,0,38+160) or UDim2.new(1,-5,0,38)}, 0.4)
                end
            end)
            -- Simple picker logic (click to random, for demo)
            Picker.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    local newColor = Color3.fromRGB(math.random(255), math.random(255), math.random(255))
                    Tween(Preview, {BackgroundColor3 = newColor}, 0.3)
                    Color = newColor
                    Fluent.Configs[flag] = Color
                    callback(Color)
                end
            end)
            return {Set = function(col) Color = col; Tween(Preview, {BackgroundColor3 = col}, 0.3) end}
        end

        -- Add TextInput with focus animation
        function Tab:AddInput(options)
            local text = options.Name or "Input"
            local default = options.Default or ""
            local flag = options.Flag or text
            local callback = options.Callback or function() end
            local Value = default
            Fluent.Configs[flag] = Value
            local Frame = Instance.new("Frame", Page)
            Frame.BackgroundColor3 = Fluent.Theme.Item
            Frame.Size = UDim2.new(1, -5, 0, 38)
            Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 6)
            local Lbl = Instance.new("TextLabel", Frame)
            Lbl.Text = text
            Lbl.Font = Enum.Font.Gotham
            Lbl.TextColor3 = Fluent.Theme.Text
            Lbl.TextSize = 14
            Lbl.BackgroundTransparency = 1
            Lbl.Position = UDim2.fromOffset(10,0)
            Lbl.Size = UDim2.new(0.5,0,1,0)
            Lbl.TextXAlignment = Enum.TextXAlignment.Left
            local Input = Instance.new("TextBox", Frame)
            Input.Size = UDim2.new(0.5, -10, 1, -10)
            Input.Position = UDim2.new(0.5, 5, 0, 5)
            Input.BackgroundColor3 = Fluent.Theme.Sidebar
            Input.TextColor3 = Fluent.Theme.Text
            Input.Font = Enum.Font.Gotham
            Input.TextSize = 14
            Input.Text = Value
            Instance.new("UICorner", Input).CornerRadius = UDim.new(0,4)
            Input.Focused:Connect(function()
                Tween(Input, {BackgroundColor3 = Color3.fromRGB(40,40,40)}, 0.2)
            end)
            Input.FocusLost:Connect(function()
                Tween(Input, {BackgroundColor3 = Fluent.Theme.Sidebar}, 0.2)
                Value = Input.Text
                Fluent.Configs[flag] = Value
                callback(Value)
            end)
            return {Set = function(val) Value = val; Input.Text = val end}
        end

        -- Add Keybind with animation
        function Tab:AddKeybind(options)
            local text = options.Name or "Keybind"
            local default = options.Default or Enum.KeyCode.Unknown
            local flag = options.Flag or text
            local callback = options.Callback or function() end
            local Key = default
            Fluent.Configs[flag] = Key
            local Frame = Instance.new("TextButton", Page)
            Frame.Text = ""
            Frame.BackgroundColor3 = Fluent.Theme.Item
            Frame.Size = UDim2.new(1, -5, 0, 38)
            Frame.AutoButtonColor = false
            Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 6)
            local Lbl = Instance.new("TextLabel", Frame)
            Lbl.Text = text
            Lbl.Font = Enum.Font.Gotham
            Lbl.TextColor3 = Fluent.Theme.Text
            Lbl.TextSize = 14
            Lbl.BackgroundTransparency = 1
            Lbl.Position = UDim2.fromOffset(10,0)
            Lbl.Size = UDim2.new(1,-60,1,0)
            Lbl.TextXAlignment = Enum.TextXAlignment.Left
            local BindLbl = Instance.new("TextLabel", Frame)
            BindLbl.Text = Key.Name
            BindLbl.Font = Enum.Font.Gotham
            BindLbl.TextColor3 = Fluent.Theme.SubText
            BindLbl.TextSize = 14
            BindLbl.BackgroundTransparency = 1
            BindLbl.Position = UDim2.new(1, -100, 0, 0)
            BindLbl.Size = UDim2.new(0,90,1,0)
            BindLbl.TextXAlignment = Enum.TextXAlignment.Right
            local binding = false
            Frame.MouseButton1Click:Connect(function()
                binding = true
                BindLbl.Text = "..."
                Tween(BindLbl, {TextColor3 = Fluent.Accent}, 0.2)
            end)
            UserInputService.InputBegan:Connect(function(input)
                if binding and input.KeyCode ~= Enum.KeyCode.Unknown then
                    binding = false
                    Key = input.KeyCode
                    Fluent.Configs[flag] = Key
                    BindLbl.Text = Key.Name
                    Tween(BindLbl, {TextColor3 = Fluent.Theme.SubText}, 0.2)
                    callback(Key)
                end
            end)
            return {Set = function(key) Key = key; BindLbl.Text = key.Name end}
        end

        return Tab
    end

    -- Initial fade in for window
    Main.Visible = true
    Tween(Main, {Transparency = 0}, 0.5)

    if configSaving.Enabled then
        Fluent:LoadConfig(configSaving.FileName)
    end

    return Window
end

return Fluent
