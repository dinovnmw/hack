--// This file was created by XHider https://discord.com/invite/E2N7w35zkt
-- Upgraded: Fixed UI visibility/animation issues, improved tween smoothness, optimized nearest chest collection with distance checks.

local player = game.Players.LocalPlayer
local UIS = game:GetService("UserInputService")
task.spawn(function()
    while task.wait(1) do
        if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
            player.Character:FindFirstChildOfClass("Humanoid"):ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end
end)

local TS = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
if CoreGui:FindFirstChild("HNC_Purple_UI") then
    CoreGui.HNC_Purple_UI:Destroy()
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "HNC_Purple_UI"
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = CoreGui

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0.5, 0, 0.15, 0)
MainFrame.Position = UDim2.new(0.5, 0, 0.15, 0)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 30)
MainFrame.BackgroundTransparency = 1
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui
MainFrame.Visible = true

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 30)
UICorner.Parent = MainFrame

local UIStroke = Instance.new("UIStroke")
UIStroke.Thickness = 0
UIStroke.Color = Color3.fromRGB(255, 255, 255)
UIStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
UIStroke.Parent = MainFrame

local ImageLabel = Instance.new("ImageLabel")
ImageLabel.Size = UDim2.new(1.5, 0, 2.5, 0)
ImageLabel.Position = UDim2.new(-0.25, 0, -0.75, 0)
ImageLabel.BackgroundTransparency = 1
ImageLabel.Image = "rbxassetid://4996891970"
ImageLabel.ImageColor3 = Color3.fromRGB(255, 255, 255)
ImageLabel.ImageTransparency = 1
ImageLabel.ZIndex = -1
ImageLabel.Parent = MainFrame

local UIGradient = Instance.new("UIGradient")
UIGradient.Color = ColorSequence.new({ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 30, 30)), ColorSequenceKeypoint.new(1, Color3.fromRGB(10, 10, 10))})
UIGradient.Rotation = 45
UIGradient.Parent = MainFrame

local TextLabel = Instance.new("TextLabel")
TextLabel.Size = UDim2.new(1, 0, 1, 0)
TextLabel.BackgroundTransparency = 1
TextLabel.Text = "DinoHub - Auto Collect Chest"
TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.Font = Enum.Font.GothamBlack
TextLabel.TextScaled = true
TextLabel.TextStrokeTransparency = 0.4
TextLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
TextLabel.TextTransparency = 1
TextLabel.Parent = MainFrame

-- Animate UI
local tweenInfo = TweenInfo.new(1.2, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
TS:Create(MainFrame, tweenInfo, {BackgroundTransparency = 0.2, Size = UDim2.new(0.5, 0, 0.15, 0)}):Play()
TS:Create(TextLabel, tweenInfo, {TextTransparency = 0}):Play()
TS:Create(UIStroke, tweenInfo, {Thickness = 3}):Play()
TS:Create(ImageLabel, tweenInfo, {ImageTransparency = 0.5}):Play()
task.wait(2)

-- Character highlight
local function AddHighlight(char)
    if not char then return end
    if char:FindFirstChild("PurpleAura") then char.PurpleAura:Destroy() end
    local highlight = Instance.new("Highlight")
    highlight.Name = "PurpleAura"
    highlight.FillColor = Color3.fromRGB(255, 255, 255)
    highlight.OutlineColor = Color3.fromRGB(220, 220, 220)
    highlight.FillTransparency = 0.2
    highlight.OutlineTransparency = 0
    highlight.Parent = char
end
if player.Character then AddHighlight(player.Character) end
player.CharacterAdded:Connect(function(char)
    char:WaitForChild("HumanoidRootPart")
    task.wait(1)
    AddHighlight(char)
end)

-- Billboard label
local RS = game:GetService("RunService")
local labelText = "Dino Hub"
local labelSize = 20
local offset = Vector3.new(0, 2, 0)
local hueSpeed = 1.2
local function AddBillboard(char)
    if not char then return end
    local head = char:FindFirstChild("Head") or char:FindFirstChildWhichIsA("BasePart")
    if not head then return end
    if head:FindFirstChild("HNC_FastAttack_Label") then head.HNC_FastAttack_Label:Destroy() end
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "HNC_FastAttack_Label"
    billboard.Adornee = head
    billboard.AlwaysOnTop = true
    billboard.Size = UDim2.new(0, 220, 0, 45)
    billboard.StudsOffset = offset
    billboard.Parent = head
    local label = Instance.new("TextLabel")
    label.Name = "Label"
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = labelText
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = labelSize
    label.TextStrokeTransparency = 0.5
    label.TextTransparency = 0
    label.TextScaled = false
    label.Parent = billboard
    local hue = 0
    local conn = RS.RenderStepped:Connect(function(delta)
        hue = (hue + delta * hueSpeed) % 1
        local color = Color3.fromHSV(hue, 0.95, 1)
        if label and label.Parent then
            label.TextColor3 = color
        else
            conn:Disconnect()
        end
    end)
end
local function OnCharacterAdded(char)
    if not char.Parent then char.AncestryChanged:Wait() end
    wait(0.1)
    AddBillboard(char)
end
if player.Character then OnCharacterAdded(player.Character) end
player.CharacterAdded:Connect(OnCharacterAdded)

-- Chest collection
local function GetCharacter()
    if not player.Character then player.CharacterAdded:Wait() end
    player.Character:WaitForChild("HumanoidRootPart")
    return player.Character
end

local function SortByDistance(parts)
    local rootPos = GetCharacter().HumanoidRootPart.Position
    table.sort(parts, function(a, b)
        return (rootPos - a.Position).Magnitude < (rootPos - b.Position).Magnitude
    end)
end

local chests = {}
local scanned = true
local function ScanChests()
    if scanned then
        scanned = false
        for _, desc in pairs(game:GetDescendants()) do
            if desc.Name:find("Chest") and desc.ClassName == "Part" then
                table.insert(chests, desc)
            end
        end
    end
    local validChests = {}
    for _, chest in pairs(chests) do
        if chest.Parent and chest:FindFirstChild("TouchInterest") then
            table.insert(validChests, chest)
        end
    end
    SortByDistance(validChests)
    return validChests
end

local noclip = false
local function SetNoclip(enable)
    for _, part in pairs(GetCharacter():GetChildren()) do
        if part:IsA("BasePart") then
            part.CanCollide = not enable
        end
    end
end

task.spawn(function()
    while task.wait(0.1) do
        if noclip and GetCharacter() and GetCharacter():FindFirstChild("Humanoid") then
            GetCharacter().Humanoid:ChangeState(Enum.HumanoidStateType.Physics)
        end
    end
end)

local useTween = true
local tweenSpeed = 250  -- Upgraded speed
local function TweenTo(pos)
    local root = GetCharacter().HumanoidRootPart
    local target = pos + Vector3.new(0, 3, 0)
    SetNoclip(true)
    if useTween then
        local dist = (root.Position - target).Magnitude
        local speed = tweenSpeed
        local time = dist / speed
        if time < 0.03 then time = 0.03 end
        local info = TweenInfo.new(time, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)  -- Smoother easing
        TS:Create(root, info, {CFrame = CFrame.new(target)}):Play()
        task.wait(time + math.random() * 0.05)
    else
        root.CFrame = CFrame.new(target)
        task.wait(0.03 + math.random() * 0.05)
    end
    SetNoclip(noclip)
end

local function CollectLoop()
    task.spawn(function()
        while task.wait(0.05 + math.random() * 0.1) do
            local nearChests = ScanChests()
            if #nearChests > 0 then
                TweenTo(nearChests[1].CFrame)  -- Collect nearest
            else
                TeleportLoop()
                break
            end
        end
    end)
end

task.spawn(function()
    local RS = game:GetService("ReplicatedStorage")
    while task.wait(5 + math.random(5)) do
        pcall(function()
            RS.Remotes.CommF_:InvokeServer("SetTeam", "Marines")
        end)
    end
end)

player.CharacterAdded:Connect(function()
    task.wait(1 + math.random())
    if noclip then SetNoclip(true) end
    CollectLoop()
end)
CollectLoop()

-- Server hopping
repeat task.wait(2) until game:IsLoaded()
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local PlaceId = game.PlaceId
local servers = {}
local cursor = ""
local hour = os.date("!*t").hour
local success, err = pcall(function()
    servers = HttpService:JSONDecode(readfile("NotSameServers.json"))
end)
if not success then
    table.insert(servers, hour)
    writefile("NotSameServers.json", HttpService:JSONEncode(servers))
end

local function ShowHopUI()
    local gui = Instance.new("ScreenGui")
    gui.Name = "HNC_Hub_HopUI"
    gui.ResetOnSpawn = false
    gui.IgnoreGuiInset = true
    gui.Parent = CoreGui
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, 0, 1, 0)
    frame.BackgroundColor3 = Color3.new(0, 0, 0)
    frame.BorderSizePixel = 0
    frame.BackgroundTransparency = 0
    frame.Parent = gui
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0.2, 0)
    title.Position = UDim2.new(0, 0, 0.35, 0)
    title.BackgroundTransparency = 1
    title.Text = "DinoHUB - Auto Collect Chest"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.Font = Enum.Font.SourceSansBold
    title.TextScaled = true
    title.Parent = frame
    local status = Instance.new("TextLabel")
    status.Size = UDim2.new(1, 0, 0.2, 0)
    status.Position = UDim2.new(0, 0, 0.5, 0)
    status.BackgroundTransparency = 1
    status.Text = "Hopping to new server..."
    status.TextColor3 = Color3.fromRGB(255, 170, 0)
    status.Font = Enum.Font.SourceSansBold
    status.TextScaled = true
    status.Parent = frame
end

function TPReturner()
    local data
    local url
    if cursor == "" then
        url = "https://games.roblox.com/v1/games/" .. PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"
    else
        url = "https://games.roblox.com/v1/games/" .. PlaceId .. "/servers/Public?sortOrder=Asc&limit=100&cursor=" .. cursor
    end
    data = HttpService:JSONDecode(game:HttpGet(url))
    if data.nextPageCursor and data.nextPageCursor ~= "null" then
        cursor = data.nextPageCursor
    end
    local count = 0
    for _, server in pairs(data.data) do
        local id = tostring(server.id)
        local valid = true
        if tonumber(server.playing) < tonumber(server.maxPlayers) then
            for _, s in pairs(servers) do
                if count ~= 0 then
                    if id == tostring(s) then
                        valid = false
                    end
                else
                    if tonumber(hour) ~= tonumber(s) then
                        pcall(function()
                            delfile("NotSameServers.json")
                            servers = {}
                            table.insert(servers, hour)
                        end)
                    end
                end
                count = count + 1
            end
            if valid then
                table.insert(servers, id)
                pcall(function()
                    writefile("NotSameServers.json", HttpService:JSONEncode(servers))
                    ShowHopUI()
                    task.wait(3 + math.random(2))
                    TeleportService:TeleportToPlaceInstance(PlaceId, id, LocalPlayer)
                end)
                task.wait(4)
            end
        end
    end
end

function TeleportLoop()
    while task.wait(1 + math.random()) do
        pcall(function()
            TPReturner()
            if cursor ~= "" then
                TPReturner()
            end
        end)
    end
end

-- Mini UI
if CoreGui:FindFirstChild("HN_MiniUI") then
    CoreGui.HN_MiniUI:Destroy()
end
local MiniGui = Instance.new("ScreenGui")
MiniGui.Name = "HN_MiniUI"
MiniGui.Parent = CoreGui

local function CreateToggle(text, offset, default, callback)
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0, 140, 0, 18)
    label.Position = UDim2.new(1, -160, 0.1, offset)
    label.AnchorPoint = Vector2.new(0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 14
    label.Parent = MiniGui
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 25, 0, 25)
    button.Position = UDim2.new(1, -80, 0.1, offset + 18)
    button.AnchorPoint = Vector2.new(0, 0)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 16
    button.Font = Enum.Font.GothamBold
    button.Parent = MiniGui
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(1, 0)
    corner.Parent = button
    local enabled = default
    local function Update()
        if enabled then
            button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            button.Text = "âœ“"
        else
            button.BackgroundColor3 = Color3.fromRGB(120, 120, 120)
            button.Text = ""
        end
    end
    Update()
    button.MouseButton1Click:Connect(function()
        enabled = not enabled
        Update()
        callback(enabled)
    end)
    return function() return enabled end, function(val) enabled = val Update() callback(val) end
end

local antiKick = true
CreateToggle("Anti Kick", 0, true, function(val) antiKick = val end)
task.spawn(function()
    while task.wait(30 + math.random(20)) do
        if antiKick and player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.Health = 0
        end
    end
end)

local invisible = false
local function SetInvisible(enable)
    if player.Character then
        for _, desc in ipairs(player.Character:GetDescendants()) do
            if desc:IsA("BasePart") or desc:IsA("Decal") then
                desc.LocalTransparencyModifier = enable and 1 or 0
            end
        end
    end
end
CreateToggle("Invisible", 60, false, function(val)
    invisible = val
    SetInvisible(invisible)
end)
player.CharacterAdded:Connect(function(char)
    char:WaitForChild("HumanoidRootPart")
    task.wait(0.2 + math.random() * 0.1)
    if invisible then SetInvisible(true) end
    if noclip then SetNoclip(true) end
end)

local function SetClearMap(enable)
    for _, desc in ipairs(workspace:GetDescendants()) do
        if desc:IsA("BasePart") or desc:IsA("Decal") then
            if not desc:IsDescendantOf(player.Character) then
                desc.LocalTransparencyModifier = enable and 1 or 0
            end
        end
    end
end
CreateToggle("Clear Map", 120, false, SetClearMap)

CreateToggle("Tween Mode", 180, true, function(val) useTween = val end)

CreateToggle("Noclip", 240, false, function(val)
    noclip = val
    if noclip then SetNoclip(true) end
end)
